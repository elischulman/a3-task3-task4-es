---
title: "a3_task3_eli_schulman"
author: "Eli Schulman"
date: "10/23/2021"
output: html_document
---

Overview:

***Data Citation: ***

```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

# attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(lubridate)
```

```{r}
urchins <- read_csv(here("data", "urchins.csv")) %>% 
  clean_names()
```

### Purple vs Red urchins (distributions of sizes)

```{r}
ggplot(urchins, aes(x = size)) +
  geom_histogram(aes(fill = common_name), bins = 10) +
  labs(title = "Purple and Red Urchin Size Distribution",
       x = "Diameter (cm)",
       y = "# of Urchins",
       fill = "Urchin Color") +
# change legends color
  scale_fill_manual(values = c("blueviolet","red3")) +
# center the plot title
  theme(plot.title = element_text(hjust = .5)) +
  facet_wrap(~ common_name)
```

### Descriptive statistics for Urchins

```{r}
urchins_stats <- urchins %>% 
  group_by(common_name) %>% 
  summarize(mean = round(mean(size), 2),
            median = round(median(size), 2),
            sd = round(sd(size), 2),
            sample_size = n())

kable(urchins_stats, 
      col.names = c('Species', 'Mean (cm)', 'Median (cm)', 'Standard Deviation (cm)', 'Sample Size'),
      caption = "Summary Statistics of Urchin Species Body Diameters") %>% 
  kable_styling(full_width = FALSE)
```

### Takeaway from urchin species distribution and stats summary: 
#### The red urchins are more normaly distributed, and have a larger mean diameter relative to the purple urchins (6.78 cm vs 4.47 cm). Additionally, the red urchins have a larger spread in observed diameters compared to their mean.

## Section 2

### Explore purple urchins counts by site by year. Store a table of these values

```{r}
purple_urchins <- urchins %>% 
  filter(common_name == "Purple Urchin") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date)) %>% 
  mutate(site_full = case_when(
    site == "NAPL" ~ "Naples Reef",
    site == "AQUE" ~ "Arroyo Quenado Reef",
    site == 'CARP' ~ 'Carpinteria Reef',
    site == 'MOHK' ~ 'Mohawk Reef',
    site == 'IVEE' ~ 'Isla Vista Reef',
    TRUE ~ "NA"
  ))

# Create summary table
purple_urchins_trend <- purple_urchins %>% 
  group_by(year, site_full) %>% 
  summarize(count = n())
```

### Graph Purple Urchin trends by site by year

```{r}

```




